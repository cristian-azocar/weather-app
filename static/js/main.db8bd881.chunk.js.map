{"version":3,"sources":["components/Map/styles.ts","components/Map/Map.tsx","components/WeatherDialog/styles.ts","components/WeatherDialog/WeatherDialog.tsx","assets/images/welcome-image.png","components/WelcomeDialog/styles.ts","components/WelcomeDialog/WelcomeDialog.tsx","services/WeatherService/WeatherService.ts","contexts/WeatherContext/WeatherContext.tsx","App.tsx","utils/localStorage-utils/localStorage-utils.ts","hooks/useMergeState/useMergeState.tsx","index.tsx"],"names":["makeStyles","mapContainer","width","height","defaultProps","center","onClick","undefined","MapConsumer","props","useMapEvents","click","e","latlng","lat","lng","latitude","longitude","Map","classes","useStyles","MapContainer","id","zoom","className","TileLayer","attribution","url","theme","dialogTitle","padding","spacing","dialogPaper","minHeight","dialogContent","display","alignItems","justifyContent","closeButton","position","right","top","grid","textAlign","errorIcon","fontSize","loading","weather","error","onClose","onRetry","WeatherDialog","open","Dialog","maxWidth","fullWidth","paper","DialogTitle","disableTypography","Typography","variant","IconButton","DialogContent","CircularProgress","size","Grid","container","direction","item","color","Button","current","temp","alt","src","icon","description","breakpoints","only","margin","maxHeight","borderRadius","dialogActions","gridContainer","flexDirection","gridItem","flexGrow","WelcomeDialog","Box","welcomeImage","align","fontWeight","marginBottom","marginTop","symbol","label","Link","href","target","rel","underline","DialogActions","baseUrl","process","a","this","axios","get","data","WeatherContext","createContext","WeatherContextProvider","children","useState","fetchWeather","state","weatherService","Provider","value","initialWeatherDialogState","initialWelcomeDialogState","key","localStorage","getItem","JSON","parse","localStorageUtils","App","initialState","setState","useCallback","previousState","useMergeState","weatherDialog","setWeatherDialog","welcomeDialog","setWelcomeDialog","lastCoordinatesRef","useRef","useContext","fetchAndDisplayWeather","coordinates","setItem","stringify","Error","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.db8bd881.chunk.js","sourcesContent":["import { makeStyles } from '@material-ui/core/styles';\n\nexport default makeStyles(() => ({\n  mapContainer: {\n    width: '100%',\n    height: '100vh',\n  },\n}));\n","import { LeafletMouseEvent } from 'leaflet';\nimport { MapContainer, TileLayer, useMapEvents } from 'react-leaflet';\nimport useStyles from './styles';\n\ntype MapProps = {\n  center?: CoordinatesTuple;\n  onClick?: (coordinates: Coordinates) => void;\n};\n\nexport type Coordinates = {\n  latitude: number;\n  longitude: number;\n};\n\nexport type CoordinatesTuple = [number, number];\n\nconst defaultProps: MapProps = {\n  center: [-33.448, -70.669],\n  onClick: undefined,\n};\n\nfunction MapConsumer(props: MapProps): null {\n  const { onClick } = props;\n\n  useMapEvents({\n    click: (e: LeafletMouseEvent): void => {\n      const { lat, lng } = e.latlng;\n      const coordinates: Coordinates = { latitude: lat, longitude: lng };\n      onClick?.(coordinates);\n    },\n  });\n\n  return null;\n}\n\nfunction Map(props: MapProps): JSX.Element {\n  const { center, onClick } = props;\n  const classes = useStyles();\n\n  return (\n    <MapContainer\n      id=\"map\"\n      center={center}\n      zoom={4}\n      className={classes.mapContainer}\n    >\n      <TileLayer\n        attribution='&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\n        url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n      />\n      <MapConsumer onClick={onClick} />\n    </MapContainer>\n  );\n}\n\nMap.defaultProps = defaultProps;\n\nexport default Map;\n","import { makeStyles } from '@material-ui/core/styles';\n\nexport default makeStyles((theme) => ({\n  dialogTitle: {\n    padding: theme.spacing(2),\n  },\n  dialogPaper: {\n    minHeight: 290,\n  },\n  dialogContent: {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  closeButton: {\n    position: 'absolute',\n    right: theme.spacing(1),\n    top: theme.spacing(1),\n  },\n  grid: {\n    textAlign: 'center',\n  },\n  errorIcon: {\n    fontSize: 80,\n  },\n}));\n","import Dialog from '@material-ui/core/Dialog';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Grid from '@material-ui/core/Grid';\nimport IconButton from '@material-ui/core/IconButton';\nimport Typography from '@material-ui/core/Typography';\nimport CloseIcon from '@material-ui/icons/Close';\nimport ErrorOutline from '@material-ui/icons/ErrorOutline';\nimport { Button } from '@material-ui/core';\nimport { IWeather } from '../../types/interfaces';\nimport useStyles from './styles';\n\ntype WeatherDialogProps = {\n  open: boolean;\n  loading?: boolean;\n  weather?: IWeather;\n  error?: Error;\n  onClose?: () => void;\n  onRetry?: () => void;\n};\n\nconst defaultProps: Partial<WeatherDialogProps> = {\n  loading: false,\n  weather: undefined,\n  error: undefined,\n  onClose: undefined,\n  onRetry: undefined,\n};\n\nfunction WeatherDialog(props: WeatherDialogProps): JSX.Element {\n  const { open, loading, weather, error, onClose, onRetry } = props;\n  const classes = useStyles();\n\n  function renderContent(): JSX.Element {\n    if (loading) {\n      return <CircularProgress size={80} />;\n    }\n\n    if (error) {\n      return (\n        <Grid container direction=\"column\" alignItems=\"center\" spacing={2}>\n          <Grid item>\n            <ErrorOutline color=\"error\" className={classes.errorIcon} />\n          </Grid>\n          <Grid item>\n            <Typography variant=\"h5\">Oops! Something went wrong</Typography>\n          </Grid>\n          <Grid item>\n            <Button variant=\"contained\" color=\"primary\" onClick={onRetry}>\n              Retry\n            </Button>\n          </Grid>\n        </Grid>\n      );\n    }\n\n    return (\n      <Grid\n        container\n        direction=\"column\"\n        alignItems=\"center\"\n        className={classes.grid}\n      >\n        <Grid item>\n          <Typography variant=\"h4\">{weather?.current.temp}&deg;</Typography>\n        </Grid>\n        <Grid item>\n          <img\n            alt=\"icon\"\n            src={`https://openweathermap.org/img/wn/${weather?.current.weather[0].icon}@2x.png`}\n          />\n        </Grid>\n        <Grid item>\n          <Typography variant=\"h5\">\n            {weather?.current.weather[0].description}\n          </Typography>\n        </Grid>\n      </Grid>\n    );\n  }\n\n  return (\n    <Dialog\n      open={open}\n      onClose={onClose}\n      maxWidth=\"xs\"\n      fullWidth\n      classes={{ paper: classes.dialogPaper }}\n    >\n      <DialogTitle disableTypography className={classes.dialogTitle}>\n        <Typography variant=\"h6\">Current Weather</Typography>\n        <IconButton className={classes.closeButton} onClick={onClose}>\n          <CloseIcon />\n        </IconButton>\n      </DialogTitle>\n      <DialogContent className={classes.dialogContent}>\n        {renderContent()}\n      </DialogContent>\n    </Dialog>\n  );\n}\n\nWeatherDialog.defaultProps = defaultProps;\n\nexport default WeatherDialog;\n","export default __webpack_public_path__ + \"static/media/welcome-image.3f91deb7.png\";","import { makeStyles } from '@material-ui/core/styles';\n\nexport default makeStyles((theme) => ({\n  dialogPaper: {\n    [theme.breakpoints.only('xs')]: {\n      width: '100%',\n      height: '100%',\n      margin: '0px',\n      maxWidth: '100%',\n      maxHeight: 'none',\n      borderRadius: '0px',\n    },\n  },\n  dialogActions: {\n    justifyContent: 'center',\n  },\n  gridContainer: {\n    height: '100%',\n    alignItems: 'center',\n    flexDirection: 'column',\n    [theme.breakpoints.only('xs')]: {\n      flexDirection: 'row',\n    },\n  },\n  gridItem: {\n    flexGrow: 1,\n  },\n}));\n","import Emoji from 'a11y-react-emoji';\nimport Grid from '@material-ui/core/Grid';\nimport Typography from '@material-ui/core/Typography';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport Box from '@material-ui/core/Box';\nimport Button from '@material-ui/core/Button';\nimport Link from '@material-ui/core/Link';\nimport welcomeImage from '../../assets/images/welcome-image.png';\nimport useStyles from './styles';\n\ntype WelcomeDialogProps = {\n  open: boolean;\n  onClose?: () => void;\n};\n\nconst defaultProps: Partial<WelcomeDialogProps> = {\n  onClose: undefined,\n};\n\nfunction WelcomeDialog(props: WelcomeDialogProps): JSX.Element {\n  const { open, onClose } = props;\n  const classes = useStyles();\n\n  return (\n    <Dialog open={open} classes={{ paper: classes.dialogPaper }}>\n      <DialogContent>\n        <Grid container className={classes.gridContainer}>\n          <Grid item className={classes.gridItem}>\n            <Box textAlign=\"center\">\n              <img src={welcomeImage} alt=\"welcome\" />\n            </Box>\n          </Grid>\n          <Grid item className={classes.gridItem}>\n            <Typography variant=\"h5\" align=\"center\">\n              <Box fontWeight=\"bold\" marginBottom=\"20px\" marginTop=\"20px\">\n                Welcome to Weather App! <Emoji symbol=\"üëã\" label=\"wave-hand\" />\n              </Box>\n            </Typography>\n          </Grid>\n          <Grid item className={classes.gridItem}>\n            <Typography align=\"center\">\n              Hello there! My name is{' '}\n              <Link\n                href=\"https://github.com/cristian-azocar\"\n                target=\"_blank\"\n                rel=\"noreferrer\"\n                underline=\"always\"\n              >\n                Cristian Az√≥car\n              </Link>{' '}\n              and I made this simple web application for fun. Just select a\n              place on the map and see the current temperature. If you want to\n              know more, visit the{' '}\n              <Link\n                href=\"https://github.com/cristian-azocar/weather-app\"\n                target=\"_blank\"\n                rel=\"noreferrer\"\n                underline=\"always\"\n              >\n                repository.\n              </Link>\n            </Typography>\n          </Grid>\n        </Grid>\n      </DialogContent>\n      <DialogActions className={classes.dialogActions}>\n        <Button variant=\"contained\" color=\"primary\" onClick={onClose}>\n          OK, got it!\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n}\n\nWelcomeDialog.defaultProps = defaultProps;\n\nexport default WelcomeDialog;\n","import axios from 'axios';\nimport { IWeather } from '../../types/interfaces';\n\nexport class WeatherService {\n  private baseUrl: string = process.env.REACT_APP_API_BASE_URL || '';\n\n  async fetchWeather(latitude: number, longitude: number): Promise<IWeather> {\n    const url = `${this.baseUrl}/api/weather?latitude=${latitude}&longitude=${longitude}`;\n    const { data } = await axios.get<IWeather>(url);\n\n    return data;\n  }\n}\n\nexport default new WeatherService();\n","import { createContext, PropsWithChildren, useContext, useState } from 'react';\nimport { IWeather } from '../../types/interfaces';\nimport weatherService from '../../services/WeatherService';\n\ntype WeatherContextType = {\n  fetchWeather: (latitude: number, longitude: number) => Promise<IWeather>;\n};\n\nconst WeatherContext = createContext({} as WeatherContextType);\n\nexport function WeatherContextProvider(\n  props: PropsWithChildren<unknown>\n): JSX.Element {\n  const { children } = props;\n  const [state] = useState<WeatherContextType>({ fetchWeather });\n\n  async function fetchWeather(\n    latitude: number,\n    longitude: number\n  ): Promise<IWeather> {\n    const weather: IWeather = await weatherService.fetchWeather(\n      latitude,\n      longitude\n    );\n\n    return weather;\n  }\n\n  return (\n    <WeatherContext.Provider value={state}>{children}</WeatherContext.Provider>\n  );\n}\n\nexport function useWeather(): WeatherContextType {\n  return useContext(WeatherContext);\n}\n\nexport default WeatherContext;\n","import { useRef, useState } from 'react';\nimport Map, { Coordinates } from './components/Map';\nimport WeatherDialog from './components/WeatherDialog';\nimport WelcomeDialog from './components/WelcomeDialog';\nimport { useWeather } from './contexts/WeatherContext';\nimport useMergeState from './hooks/useMergeState';\nimport { IWeather } from './types/interfaces';\nimport * as localStorageUtils from './utils/localStorage-utils';\n\ntype WeatherDialogState = {\n  open: boolean;\n  loading?: boolean;\n  weather?: IWeather;\n  error?: Error;\n};\n\nconst initialWeatherDialogState: WeatherDialogState = {\n  open: false,\n  loading: false,\n  weather: undefined,\n  error: undefined,\n};\n\nconst initialWelcomeDialogState = {\n  open: !localStorageUtils.getItem('welcomeDialogSeen'),\n};\n\nexport default function App(): JSX.Element {\n  const [weatherDialog, setWeatherDialog] = useMergeState(\n    initialWeatherDialogState\n  );\n  const [welcomeDialog, setWelcomeDialog] = useState(initialWelcomeDialogState);\n  const lastCoordinatesRef = useRef<Coordinates>();\n  const { fetchWeather } = useWeather();\n\n  function handleMapClick(coordinates: Coordinates): void {\n    lastCoordinatesRef.current = coordinates;\n    fetchAndDisplayWeather(coordinates);\n  }\n\n  function retryWeatherFetch(): void {\n    if (!lastCoordinatesRef.current) {\n      throw new Error('No coordinates have been selected yet');\n    }\n\n    fetchAndDisplayWeather(lastCoordinatesRef.current);\n  }\n\n  function closeWeatherDialog(): void {\n    setWeatherDialog({ open: false });\n  }\n\n  function closeWelcomeDialog(): void {\n    localStorageUtils.setItem('welcomeDialogSeen', true);\n    setWelcomeDialog({ open: false });\n  }\n\n  async function fetchAndDisplayWeather(\n    coordinates: Coordinates\n  ): Promise<void> {\n    setWeatherDialog({ open: true, loading: true });\n\n    try {\n      const { latitude, longitude } = coordinates;\n      const weather: IWeather = await fetchWeather(latitude, longitude);\n      setWeatherDialog({ loading: false, weather });\n    } catch (error) {\n      setWeatherDialog({ loading: false, error });\n    }\n  }\n\n  return (\n    <div id=\"app\">\n      <WelcomeDialog open={welcomeDialog.open} onClose={closeWelcomeDialog} />\n      <Map onClick={handleMapClick} />\n      <WeatherDialog\n        open={weatherDialog.open}\n        loading={weatherDialog.loading}\n        weather={weatherDialog.weather}\n        error={weatherDialog.error}\n        onClose={closeWeatherDialog}\n        onRetry={retryWeatherFetch}\n      />\n    </div>\n  );\n}\n","export function getItem(key: string): unknown {\n  const item: string | null = localStorage.getItem(key);\n\n  if (typeof item === 'string') {\n    return JSON.parse(item);\n  }\n\n  return undefined;\n}\n\nexport function setItem(key: string, value: unknown): void {\n  localStorage.setItem(key, JSON.stringify(value));\n}\n","import { Dispatch, useCallback, useState } from 'react';\n\nexport default function useMergeState<T>(\n  initialState: T\n): [T, Dispatch<Partial<T>>] {\n  const [state, setState] = useState<T>(initialState);\n  const setMergeState: Dispatch<Partial<T>> = useCallback(\n    (value: Partial<T>) => {\n      setState((previousState: T) => ({ ...previousState, ...value }));\n    },\n    []\n  );\n\n  return [state, setMergeState];\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport { WeatherContextProvider } from './contexts/WeatherContext';\n\nReactDOM.render(\n  <React.StrictMode>\n    <WeatherContextProvider>\n      <App />\n    </WeatherContextProvider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}
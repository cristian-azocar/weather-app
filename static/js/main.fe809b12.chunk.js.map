{"version":3,"sources":["components/Map/styles.ts","components/Map/Map.tsx","components/WeatherDialog/styles.ts","components/WeatherDialog/WeatherDialog.tsx","services/WeatherService/WeatherService.ts","contexts/WeatherContext/WeatherContext.tsx","App.tsx","hooks/useMergeState/useMergeState.tsx","index.tsx"],"names":["makeStyles","mapContainer","width","height","defaultProps","center","onClick","undefined","MapConsumer","props","useMapEvents","click","e","latlng","lat","lng","latitude","longitude","Map","classes","useStyles","MapContainer","id","zoom","className","TileLayer","attribution","url","theme","dialogTitle","padding","spacing","dialogPaper","minHeight","dialogContent","display","alignItems","justifyContent","closeButton","position","right","top","grid","textAlign","errorIcon","fontSize","loading","weather","error","onClose","onRetry","WeatherDialog","open","Dialog","maxWidth","fullWidth","paper","DialogTitle","disableTypography","Typography","variant","IconButton","DialogContent","CircularProgress","size","Grid","container","direction","item","color","Button","current","temp","alt","src","icon","timezone","description","baseUrl","process","a","this","axios","get","data","WeatherContext","createContext","WeatherContextProvider","children","useState","fetchWeather","state","weatherService","Provider","value","initialDialogState","App","initialState","setState","useCallback","previousState","useMergeState","weatherDialog","setWeatherDialog","lastCoordinatesRef","useRef","useContext","fetchAndDisplayWeather","coordinates","Error","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"8NAEeA,eAAW,iBAAO,CAC/BC,aAAc,CACZC,MAAO,OACPC,OAAQ,a,OCWNC,EAAyB,CAC7BC,OAAQ,EAAE,QAAS,QACnBC,aAASC,GAGX,SAASC,EAAYC,GAAwB,IACnCH,EAAYG,EAAZH,QAUR,OARAI,YAAa,CACXC,MAAO,SAACC,GAAgC,IAAD,EAChBA,EAAEC,OAAfC,EAD6B,EAC7BA,IAAKC,EADwB,EACxBA,IAEN,OAAPT,QAAO,IAAPA,KADiC,CAAEU,SAAUF,EAAKG,UAAWF,OAK1D,KAGT,SAASG,EAAIT,GAA+B,IAClCJ,EAAoBI,EAApBJ,OAAQC,EAAYG,EAAZH,QACVa,EAAUC,IAEhB,OACE,eAACC,EAAA,EAAD,CACEC,GAAG,MACHjB,OAAQA,EACRkB,KAAM,EACNC,UAAWL,EAAQlB,aAJrB,UAME,cAACwB,EAAA,EAAD,CACEC,YAAY,yEACZC,IAAI,uDAEN,cAACnB,EAAD,CAAaF,QAASA,OAK5BY,EAAId,aAAeA,EAEJc,Q,0GCvDAlB,eAAW,SAAC4B,GAAD,MAAY,CACpCC,YAAa,CACXC,QAASF,EAAMG,QAAQ,IAEzBC,YAAa,CACXC,UAAW,KAEbC,cAAe,CACbC,QAAS,OACTC,WAAY,SACZC,eAAgB,UAElBC,YAAa,CACXC,SAAU,WACVC,MAAOZ,EAAMG,QAAQ,GACrBU,IAAKb,EAAMG,QAAQ,IAErBW,KAAM,CACJC,UAAW,UAEbC,UAAW,CACTC,SAAU,QCDRzC,EAA4C,CAChD0C,SAAS,EACTC,aAASxC,EACTyC,WAAOzC,EACP0C,aAAS1C,EACT2C,aAAS3C,GAGX,SAAS4C,EAAc1C,GAAyC,IACtD2C,EAAoD3C,EAApD2C,KAAMN,EAA8CrC,EAA9CqC,QAASC,EAAqCtC,EAArCsC,QAASC,EAA4BvC,EAA5BuC,MAAOC,EAAqBxC,EAArBwC,QAASC,EAAYzC,EAAZyC,QAC1C/B,EAAUC,IAmDhB,OACE,eAACiC,EAAA,EAAD,CACED,KAAMA,EACNH,QAASA,EACTK,SAAS,KACTC,WAAS,EACTpC,QAAS,CAAEqC,MAAOrC,EAAQa,aAL5B,UAOE,eAACyB,EAAA,EAAD,CAAaC,mBAAiB,EAAClC,UAAWL,EAAQU,YAAlD,UACE,cAAC8B,EAAA,EAAD,CAAYC,QAAQ,KAApB,6BACA,cAACC,EAAA,EAAD,CAAYrC,UAAWL,EAAQmB,YAAahC,QAAS2C,EAArD,SACE,cAAC,IAAD,SAGJ,cAACa,EAAA,EAAD,CAAetC,UAAWL,EAAQe,cAAlC,SA9DEY,EACK,cAACiB,EAAA,EAAD,CAAkBC,KAAM,KAG7BhB,EAEA,eAACiB,EAAA,EAAD,CAAMC,WAAS,EAACC,UAAU,SAAS/B,WAAW,SAASL,QAAS,EAAhE,UACE,cAACkC,EAAA,EAAD,CAAMG,MAAI,EAAV,SACE,cAAC,IAAD,CAAcC,MAAM,QAAQ7C,UAAWL,EAAQyB,cAEjD,cAACqB,EAAA,EAAD,CAAMG,MAAI,EAAV,SACE,cAACT,EAAA,EAAD,CAAYC,QAAQ,KAApB,0CAEF,cAACK,EAAA,EAAD,CAAMG,MAAI,EAAV,SACE,cAACE,EAAA,EAAD,CAAQV,QAAQ,YAAYS,MAAM,UAAU/D,QAAS4C,EAArD,wBASN,eAACe,EAAA,EAAD,CACEC,WAAS,EACTC,UAAU,SACV/B,WAAW,SACXZ,UAAWL,EAAQuB,KAJrB,UAME,cAACuB,EAAA,EAAD,CAAMG,MAAI,EAAV,SACE,eAACT,EAAA,EAAD,CAAYC,QAAQ,KAApB,iBAA0Bb,QAA1B,IAA0BA,OAA1B,EAA0BA,EAASwB,QAAQC,KAA3C,YAEF,cAACP,EAAA,EAAD,CAAMG,MAAI,EAAV,SACE,qBACEK,IAAI,OACJC,IAAG,kDAAsC3B,QAAtC,IAAsCA,OAAtC,EAAsCA,EAASwB,QAAQxB,QAAQ,GAAG4B,KAAlE,eAGP,eAACV,EAAA,EAAD,CAAMG,MAAI,EAAV,UACE,cAACT,EAAA,EAAD,CAAYC,QAAQ,KAApB,gBAA0Bb,QAA1B,IAA0BA,OAA1B,EAA0BA,EAAS6B,WACnC,cAACjB,EAAA,EAAD,CAAYC,QAAQ,KAApB,gBACGb,QADH,IACGA,OADH,EACGA,EAASwB,QAAQxB,QAAQ,GAAG8B,yBA4BzC1B,EAAc/C,aAAeA,EAEd+C,Q,iCC5FA,MAXf,iDACU2B,QAAkBC,yCAD5B,uFAGE,WAAmB/D,EAAkBC,GAArC,mBAAA+D,EAAA,6DACQrD,EADR,UACiBsD,KAAKH,QADtB,iCACsD9D,EADtD,sBAC4EC,GAD5E,SAEyBiE,IAAMC,IAAcxD,GAF7C,uBAEUyD,EAFV,EAEUA,KAFV,kBAISA,GAJT,gDAHF,iECKMC,EAAiBC,wBAAc,IAE9B,SAASC,EACd9E,GACc,IACN+E,EAAa/E,EAAb+E,SADK,EAEGC,mBAA6B,CAAEC,aAFlC,gDAENC,EAFM,gEAIb,WACE3E,EACAC,GAFF,eAAA+D,EAAA,sEAIkCY,EAAeF,aAC7C1E,EACAC,GANJ,cAIQ8B,EAJR,yBASSA,GATT,4CAJa,sBAgBb,OACE,cAACsC,EAAeQ,SAAhB,CAAyBC,MAAOH,EAAhC,SAAwCH,IAQ7BH,I,QCvBf,IAAMU,EAAyC,CAC7C3C,MAAM,EACNN,SAAS,EACTC,aAASxC,EACTyC,WAAOzC,GAGM,SAASyF,IAAoB,IAAD,ECnB5B,SACbC,GAC4B,IAAD,EACDR,mBAAYQ,GADX,mBACpBN,EADoB,KACbO,EADa,KAS3B,MAAO,CAACP,EAPoCQ,uBAC1C,SAACL,GACCI,GAAS,SAACE,GAAD,mBAAC,eAA2BA,GAAkBN,QAEzD,KDYwCO,CAAcN,GADf,mBAClCO,EADkC,KACnBC,EADmB,KAEnCC,EAAqBC,mBACnBf,EDUDgB,qBAAWrB,GCVVK,aAHiC,SAsB1BiB,EAtB0B,8EAsBzC,WACEC,GADF,mBAAA5B,EAAA,6DAGEuB,EAAiB,CAAEnD,MAAM,EAAMN,SAAS,IAH1C,SAMY9B,EAAwB4F,EAAxB5F,SAAUC,EAAc2F,EAAd3F,UANtB,SAOoCyE,EAAa1E,EAAUC,GAP3D,OAOU8B,EAPV,OAQIwD,EAAiB,CAAEzD,SAAS,EAAOC,YARvC,gDAUIwD,EAAiB,CAAEzD,SAAS,EAAOE,MAAK,OAV5C,0DAtByC,sBAoCzC,OACE,sBAAK1B,GAAG,MAAR,UACE,cAAC,EAAD,CAAKhB,QAjCT,SAAwBsG,GACtBJ,EAAmBjC,QAAUqC,EAC7BD,EAAuBC,MAgCrB,cAAC,EAAD,CACExD,KAAMkD,EAAclD,KACpBN,QAASwD,EAAcxD,QACvBC,QAASuD,EAAcvD,QACvBC,MAAOsD,EAActD,MACrBC,QA1BN,WACEsD,EAAiB,CAAEnD,MAAM,KA0BrBF,QAnCN,WACE,IAAKsD,EAAmBjC,QACtB,MAAM,IAAIsC,MAAM,yCAGlBF,EAAuBH,EAAmBjC,eE9B9CuC,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAACzB,EAAD,UACE,cAACS,EAAD,QAGJiB,SAASC,eAAe,U","file":"static/js/main.fe809b12.chunk.js","sourcesContent":["import { makeStyles } from '@material-ui/core/styles';\n\nexport default makeStyles(() => ({\n  mapContainer: {\n    width: '100%',\n    height: '100vh',\n  },\n}));\n","import { LeafletMouseEvent } from 'leaflet';\nimport { MapContainer, TileLayer, useMapEvents } from 'react-leaflet';\nimport useStyles from './styles';\n\ntype MapProps = {\n  center?: CoordinatesTuple;\n  onClick?: (coordinates: Coordinates) => void;\n};\n\nexport type Coordinates = {\n  latitude: number;\n  longitude: number;\n};\n\nexport type CoordinatesTuple = [number, number];\n\nconst defaultProps: MapProps = {\n  center: [-33.448, -70.669],\n  onClick: undefined,\n};\n\nfunction MapConsumer(props: MapProps): null {\n  const { onClick } = props;\n\n  useMapEvents({\n    click: (e: LeafletMouseEvent): void => {\n      const { lat, lng } = e.latlng;\n      const coordinates: Coordinates = { latitude: lat, longitude: lng };\n      onClick?.(coordinates);\n    },\n  });\n\n  return null;\n}\n\nfunction Map(props: MapProps): JSX.Element {\n  const { center, onClick } = props;\n  const classes = useStyles();\n\n  return (\n    <MapContainer\n      id=\"map\"\n      center={center}\n      zoom={4}\n      className={classes.mapContainer}\n    >\n      <TileLayer\n        attribution='&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\n        url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n      />\n      <MapConsumer onClick={onClick} />\n    </MapContainer>\n  );\n}\n\nMap.defaultProps = defaultProps;\n\nexport default Map;\n","import { makeStyles } from '@material-ui/core/styles';\n\nexport default makeStyles((theme) => ({\n  dialogTitle: {\n    padding: theme.spacing(2),\n  },\n  dialogPaper: {\n    minHeight: 290,\n  },\n  dialogContent: {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  closeButton: {\n    position: 'absolute',\n    right: theme.spacing(1),\n    top: theme.spacing(1),\n  },\n  grid: {\n    textAlign: 'center',\n  },\n  errorIcon: {\n    fontSize: 80,\n  },\n}));\n","import Dialog from '@material-ui/core/Dialog';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Grid from '@material-ui/core/Grid';\nimport IconButton from '@material-ui/core/IconButton';\nimport Typography from '@material-ui/core/Typography';\nimport CloseIcon from '@material-ui/icons/Close';\nimport ErrorOutline from '@material-ui/icons/ErrorOutline';\nimport { Button } from '@material-ui/core';\nimport { IWeather } from '../../types/interfaces';\nimport useStyles from './styles';\n\ntype WeatherDialogProps = {\n  open: boolean;\n  loading?: boolean;\n  weather?: IWeather;\n  error?: Error;\n  onClose?: () => void;\n  onRetry?: () => void;\n};\n\nconst defaultProps: Partial<WeatherDialogProps> = {\n  loading: false,\n  weather: undefined,\n  error: undefined,\n  onClose: undefined,\n  onRetry: undefined,\n};\n\nfunction WeatherDialog(props: WeatherDialogProps): JSX.Element {\n  const { open, loading, weather, error, onClose, onRetry } = props;\n  const classes = useStyles();\n\n  function renderContent(): JSX.Element {\n    if (loading) {\n      return <CircularProgress size={80} />;\n    }\n\n    if (error) {\n      return (\n        <Grid container direction=\"column\" alignItems=\"center\" spacing={2}>\n          <Grid item>\n            <ErrorOutline color=\"error\" className={classes.errorIcon} />\n          </Grid>\n          <Grid item>\n            <Typography variant=\"h5\">Oops! Something went wrong</Typography>\n          </Grid>\n          <Grid item>\n            <Button variant=\"contained\" color=\"primary\" onClick={onRetry}>\n              Retry\n            </Button>\n          </Grid>\n        </Grid>\n      );\n    }\n\n    return (\n      <Grid\n        container\n        direction=\"column\"\n        alignItems=\"center\"\n        className={classes.grid}\n      >\n        <Grid item>\n          <Typography variant=\"h4\">{weather?.current.temp}&deg;</Typography>\n        </Grid>\n        <Grid item>\n          <img\n            alt=\"icon\"\n            src={`http://openweathermap.org/img/wn/${weather?.current.weather[0].icon}@2x.png`}\n          />\n        </Grid>\n        <Grid item>\n          <Typography variant=\"h6\">{weather?.timezone}</Typography>\n          <Typography variant=\"h5\">\n            {weather?.current.weather[0].description}\n          </Typography>\n        </Grid>\n      </Grid>\n    );\n  }\n\n  return (\n    <Dialog\n      open={open}\n      onClose={onClose}\n      maxWidth=\"xs\"\n      fullWidth\n      classes={{ paper: classes.dialogPaper }}\n    >\n      <DialogTitle disableTypography className={classes.dialogTitle}>\n        <Typography variant=\"h6\">Current Weather</Typography>\n        <IconButton className={classes.closeButton} onClick={onClose}>\n          <CloseIcon />\n        </IconButton>\n      </DialogTitle>\n      <DialogContent className={classes.dialogContent}>\n        {renderContent()}\n      </DialogContent>\n    </Dialog>\n  );\n}\n\nWeatherDialog.defaultProps = defaultProps;\n\nexport default WeatherDialog;\n","import axios from 'axios';\nimport { IWeather } from '../../types/interfaces';\n\nexport class WeatherService {\n  private baseUrl: string = process.env.REACT_APP_API_BASE_URL || '';\n\n  async fetchWeather(latitude: number, longitude: number): Promise<IWeather> {\n    const url = `${this.baseUrl}/api/weather?latitude=${latitude}&longitude=${longitude}`;\n    const { data } = await axios.get<IWeather>(url);\n\n    return data;\n  }\n}\n\nexport default new WeatherService();\n","import { createContext, PropsWithChildren, useContext, useState } from 'react';\nimport { IWeather } from '../../types/interfaces';\nimport weatherService from '../../services/WeatherService';\n\ntype WeatherContextType = {\n  fetchWeather: (latitude: number, longitude: number) => Promise<IWeather>;\n};\n\nconst WeatherContext = createContext({} as WeatherContextType);\n\nexport function WeatherContextProvider(\n  props: PropsWithChildren<unknown>\n): JSX.Element {\n  const { children } = props;\n  const [state] = useState<WeatherContextType>({ fetchWeather });\n\n  async function fetchWeather(\n    latitude: number,\n    longitude: number\n  ): Promise<IWeather> {\n    const weather: IWeather = await weatherService.fetchWeather(\n      latitude,\n      longitude\n    );\n\n    return weather;\n  }\n\n  return (\n    <WeatherContext.Provider value={state}>{children}</WeatherContext.Provider>\n  );\n}\n\nexport function useWeather(): WeatherContextType {\n  return useContext(WeatherContext);\n}\n\nexport default WeatherContext;\n","import { useRef } from 'react';\nimport Map, { Coordinates } from './components/Map';\nimport WeatherDialog from './components/WeatherDialog';\nimport { useWeather } from './contexts/WeatherContext';\nimport useMergeState from './hooks/useMergeState';\nimport { IWeather } from './types/interfaces';\n\ntype WeatherDialogState = {\n  open: boolean;\n  loading?: boolean;\n  weather?: IWeather;\n  error?: Error;\n};\n\nconst initialDialogState: WeatherDialogState = {\n  open: false,\n  loading: false,\n  weather: undefined,\n  error: undefined,\n};\n\nexport default function App(): JSX.Element {\n  const [weatherDialog, setWeatherDialog] = useMergeState(initialDialogState);\n  const lastCoordinatesRef = useRef<Coordinates>();\n  const { fetchWeather } = useWeather();\n\n  function handleMapClick(coordinates: Coordinates): void {\n    lastCoordinatesRef.current = coordinates;\n    fetchAndDisplayWeather(coordinates);\n  }\n\n  function retryWeatherFetch(): void {\n    if (!lastCoordinatesRef.current) {\n      throw new Error('No coordinates have been selected yet');\n    }\n\n    fetchAndDisplayWeather(lastCoordinatesRef.current);\n  }\n\n  function closeDialog(): void {\n    setWeatherDialog({ open: false });\n  }\n\n  async function fetchAndDisplayWeather(\n    coordinates: Coordinates\n  ): Promise<void> {\n    setWeatherDialog({ open: true, loading: true });\n\n    try {\n      const { latitude, longitude } = coordinates;\n      const weather: IWeather = await fetchWeather(latitude, longitude);\n      setWeatherDialog({ loading: false, weather });\n    } catch (error) {\n      setWeatherDialog({ loading: false, error });\n    }\n  }\n\n  return (\n    <div id=\"app\">\n      <Map onClick={handleMapClick} />\n      <WeatherDialog\n        open={weatherDialog.open}\n        loading={weatherDialog.loading}\n        weather={weatherDialog.weather}\n        error={weatherDialog.error}\n        onClose={closeDialog}\n        onRetry={retryWeatherFetch}\n      />\n    </div>\n  );\n}\n","import { Dispatch, useCallback, useState } from 'react';\n\nexport default function useMergeState<T>(\n  initialState: T\n): [T, Dispatch<Partial<T>>] {\n  const [state, setState] = useState<T>(initialState);\n  const setMergeState: Dispatch<Partial<T>> = useCallback(\n    (value: Partial<T>) => {\n      setState((previousState: T) => ({ ...previousState, ...value }));\n    },\n    []\n  );\n\n  return [state, setMergeState];\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport { WeatherContextProvider } from './contexts/WeatherContext';\n\nReactDOM.render(\n  <React.StrictMode>\n    <WeatherContextProvider>\n      <App />\n    </WeatherContextProvider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}